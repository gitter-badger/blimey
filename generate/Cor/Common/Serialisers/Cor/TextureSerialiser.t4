    class TextureSerialiser
        : TypeSerialiser<ITexture>
    {
        TypeSerialiser<SurfaceFormat> surfaceFormatSerialiser;

        internal TextureSerialiser () {}

        public override void Initialise(TypeSerialiserDatabase manager)
        {
            surfaceFormatSerialiser = manager.GetTypeSerialiser<SurfaceFormat>();
        }

        public override ITexture Read(BinaryReader abr)
        {
            SurfaceFormat surfaceFormat = surfaceFormatSerialiser.Read(abr);
            Int32 width = abr.ReadInt32();
            Int32 height = abr.ReadInt32();
            Int32 mipCount = abr.ReadInt32();

            IGraphicsManager gfx = null;

            ITexture texture = gfx.CreateTexture (
                width,
                height,
                mipCount );

            for (Int32 i = 0; i < mipCount; ++i)
            {
                Int32 byteCount = abr.ReadInt32();
                Byte[] rawData = abr.ReadBytes (byteCount);

                texture.SetRawData (i, rawData);
            }

            return buffer;
        }

        public override void Write(BinaryWriter abw, ITexture obj)
        {
            surfaceFormatSerialiser.Write (abw, obj.SurfaceFormat);
            abw.Write (obj.Width);
            abw.Write (obj.Height);
            abw.Write (obj.MipCount);

            for (Int32 i = 0; i < obj.MipCount; ++i)
            {
                Byte[] rawData = obj.GetRawData (i);
                abw.Write (rawData.Length);
                abw.Write (rawData);
            }
        }
    }

